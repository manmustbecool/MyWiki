---
title: "Clustering comparison"
date: "Updated: `r format(Sys.time(), '%d %B, %Y')`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Different cluster techniques

* K-Means
* Fuzzy C-Means
* Multi-Gaussian with Expectation-Maximization
* Density-based 
* Hierarchical 
* Self-Organising Maps 


```{r, warning=F, message=F}
# set plot layout 
par(mfrow=c(3,2),
     mar=c(2,2,2,1), oma=c(0,0,0,0) # margin: buttom left, top, right
     )

#  -------- K-Means

model <- kmeans(iris[,1:4], 3)
# plot with first two attributes: Sepal.Length Sepal.Width 
plot(iris[,c(1,3)], col=model$cluster, main="K-Means")
# point center of first two attributes
points(model$centers[, c(1,2)], col=1:3, pch=8, cex=2)

#  -------- Fuzzy C-Means

library(e1071)
model <- cmeans(iris[,1:4], 3, 100, m=2, method="cmeans")
plot(iris[,c(1,3)], col=model$cluster, main="Fuzzy C-Means")
points(model$centers[,c(1,2)], col=1:3, pch=8, cex=2)

#  -------- Multi-Gaussian with Expectation-Maximization

library(mclust)
model <- Mclust(iris[,1:4], 3)
plot(iris[,c(1,3)], col=model$classification, main="Multi-Gaussian with Expectation-Maximization")

#  -------- Density-based 

library(fpc)
model <- dbscan(iris[,1:4], eps=0.6, MinPts=4)
plot(iris[,c(1,3)], col=model$cluster, main="Density-based")

# --------- Hierarchical

distance <- dist(iris[,1:4], method="euclidean") 
hc <- hclust(distance, method="average")
model <- cutree(hc, 3)
plot(iris[,c(1,3)], col=model, main="Hierarchical")

# ---------- Self-Organising Maps 

library(kohonen) 
som <- som(as.matrix(scale(iris[,1:4])), somgrid(xdim=5, ydim=30, topo="hexagonal"))
## use hierarchical clustering to cluster the codebook vectors
model <- cutree(hclust(dist(som$codes)), 3)
plot(iris[,c(1,3)], col=model, main="Self-Organising Maps")


#------------------- 

library(plotly) #3D plotting
plot_ly(data = iris, x=iris$Sepal.Length, y=iris$Sepal.Width, z=iris$Petal.Length, 
        color=model, type="scatter3d", mode="markers", marker=list(size=5)) 

```


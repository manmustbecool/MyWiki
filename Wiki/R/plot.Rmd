---
title: "Plot"
output: html_document
---

# plot functions

 * points
 * lines
 * abline
 * rect : Draw One or More Rectangles
 * box  : Draw a box around the current plot
 * legend
 * text

# Plot configuration

## multiple plots in one graph
```r
# multiple plots in one graph. e.g. 2 rows, 2 columns
par(mfrow=c(2,2),
     mar=c(3,1,3,1), oma=c(0,0,0,0) # margin: buttom left, top, right
     )
     
# switch between plots
p <- par('mfg')) # get the plot 
par(mfg = p)  # focus the plot
```

##  plot with multiple Y scales
```{r}
x<- 1:10
y1 <- sample(seq(1:50), 10) 
y2 <- sample(seq(100:200), 10) 

# all sides have 2 lines of space margin to give space for axis on the right
par(oma=c(2,2,2,2)) 
# first plot
plot(x=x, y=y1, type="l", col="red") 
# tell R to draw over the first plot
par(new=T) 
# do second plot
plot(x=x, y=y2, type ="l", ylab="", yaxt='n' )  
axis(4, (range(y2)), ylab='y2') # draw second axis on the right
mtext("y2", side=4, line=2.3, adj=0.5, cex=1) # add test label on the right
```

## rotating axis labels in R

las:
0: always parallel to the axis [default],
1: always horizontal,
2: always perpendicular to the axis,
3: always vertical.

```{r}
plot(iris$Sepal.Length, las=2)
```

## label all factor in axis
```{r}
df <- iris[sample(nrow(iris), 30), ]

plot(df$Petal.Width, xaxt="n", xlab = "" )
axis(1, at=1:nrow(df), labels=df$Species, las=2, cex.axis=0.7)
```

## fill a stair step function
```{r}
y <- runif(10, 1, 5)
x <- seq_along(y)
y2 <- rep(y, each=2)[-(length(y)*2)]
x2 <- rep(x, each=2)[-1]
x3 <- c(min(x2), x2, max(x2))
y3 <- c(0, y2, 0)

plot(x, y, pch=16)

polygon(x3, y3, border=NA, col="grey60")
lines(x2, y2)

```

## plot color
```r
# create a color pattern
cl <- rainbow(5)

# transparent color
library(scales)
col <- alpha("yellow", 0.4)

```




## use legend as text box
```r
legend("topright", "(x,y)"
     , "info text" , title = "title text" # add text
     , lty=-1 , pch=NA # set lyt and pch to remove the legend symbols
     )
```


# Histogram

```{r}
# Histogram with 5 breakpoints
hist(iris$Sepal.Length, breaks=10)
```


# barplot

```{r}
m <- matrix( c(4,6,4,6,4,6), nrow=2 )
#      [,1] [,2] [,3]
# [1,]    4    4    4
# [2,]    6    6    6
barplot(m, legend=rownames(m), beside=TRUE)
```

# Boxplot

```{r}
# Sorting a boxplot based on median value
bymedian <- with(InsectSprays, reorder(spray, -count, median))
boxplot(count ~ bymedian, data = InsectSprays,
          xlab = "spray", ylab = "count", varwidth=TRUE,
          col = "lightgray")
```

# Rug plot

```{r}
# both 'density' and rug plot
x <- rexp(200)
plot(density(x))
rug(x)
```

# Q-Q plot

```{r}
x <- rnorm(100)
y <- rexp(100)
qqplot(x, y)
```


# Graph plot

```{r, warning=F}
library(igraph)

df <- data.frame(
  A=c("Dublin", "Cork", "Galway") , 
  B=c("Cork", "Galway", "Dublin"))

dfg <- graph.data.frame(d=df, directed=FALSE)

V(dfg)$color="red" # set vertex color
E(dfg)$color="blue" # set edge color

# igraph_options(plot.layout=layout_as_tree) # tree graph
plot(dfg, vertex.label=(dfg)$name)

```

tkplot(dfg)  # interactive plot

rglplot(dfg) # 3D plot


# Other
Producing Simple Graphs with R : 
http://www.harding.edu/fmccown/r/

http://personality-project.org/r/r.plottingdates.html

*Hmisc*
http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=Hmisc:Ecdf

*heatmap-or-plot-for-a-correlation-matrix*
http://stackoverflow.com/questions/15887212/heatmap-or-plot-for-a-correlation-matrix

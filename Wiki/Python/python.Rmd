---
title: "Python"
date: "Updated: `r format(Sys.time(), '%d %B, %Y')`"
---

# Basic

Install anaconda

```bash
python -V # get python version
```

# Data types

```python
type(person) # Determine the type of an object
```

## Atomic data types

```python
str() # convert variable to string
int() 
float()
bool()

```

## Complex data types

### List
  
Lists can contain any data types (including list). mutable
```python
li = [3, 4, 5]

# sub list
li[0] # 3
li[0:2] # [incluse, excluse] 3,4

# add or remove element
li = li + [6]
li = del(li[5])

# append an element
li.append('bar')

# copy: reference only
li2 = li
# copy: explicit copy 
li2 = li[:] # or li2 = list(li)

len(li) # length of list

3 in li # check if the element is in the list

matrix = [ [1, 2, 3, 4], [5, 6, 7, 8], ] # nested list
```

### Tuple
  
Tuples are immutable sequences
```python
t = 12345, 54321, 'hello!'
t[0]
```

### Set
  
A set is an unordered collection with no duplicate elements
```python
basket = {'apple', 'orange', 'apple', 'pear', 'orange', 'banana'}

# check if a element is in the set
'apple' in basket
```


### Dictionary

Dictionaries store key-value pairs, kind of like JSON objects.
```python
# Creating an empty dictionary
data = {} # OR data = dict()

# Creating a dictionary with initial values
data = {'a':1,'b':2,'c':3} # OR data = dict(a=1, b=2, c=3)

# Inserting/Updating a single value
data['a']=1  # Updates if 'a' exists, else adds 'a'
# OR data.update(a=1)

# Inserting/Updating multiple values
data.update({'c':3,'d':4})  # Updates 'c' and adds 'd'

# create a dictionary
person = {
            "name": "Amos",
            "age": 23,
            "hobbies": ["Travelling", "Swimming", "Coding", "Music"]
        }

# iterate through the dict and print the keys
for key in person:
    print(key)

# iterate through the dict's keys and print their values
for key in person:
    print(person[key])
```

# Other Data Structures

## DataTime

```python
from datetime import datetime

now = datetime.now()
print("Now: ", now)

now.year #  now.month or now.hour, etc
now.strftime('%Y-%m-%d %H:%M:%S') # fromt timestamp
now - timedelta(days=2) # Day before Yesterday

# remove data time instance is NaT in a dataframe
df = df[df[3].apply(lambda x: not isinstance(x, pd._libs.tslib.NaTType))]
```

## Numpy::Array
Array can only cotain one type
```python
# convert list to array
li = [3, 4, 5]
np_array = np.array(li)

# shape of array
np_array.shape

# delete an element
np.delete(a, index)


# a range value
np.arange(0, 5, 0.5)
# Out[32]: array([0. , 0.5, 1. , 1.5, 2. , 2.5, 3. , 3.5, 4. , 4.5])

# a random integer value
np.random.randint(10, size=2) # add replace=False for non duplicated values

```
**Initialize data frame**

```python
mat = np.array([[1,2,3], [1,2,3], [1,2,3]])
print(mat)
#     [[1 2 3]
#     [1 2 3]
#     [1 2 3]]

np.sum(mat, axis=1)  # axis=1  "get the sum of each the columns" 
```

## Panda::Series

http://manishamde.github.io/blog/2013/03/07/pandas-and-python-top-10/

A one-dimensional labeled array A capable of holding any data type

```python
s = pd.Series([3, -5, 7, 4], index=['a', 'b', 'c', 'd'])

```
## Panda::DataFrame

**Initialize data frame**

```python
df = pd.DataFrame(
          {"a":[11 ,12, 13], "b":[21, 22, 23], "c":[31, 32, 33]},    
          index = [1, 2, 3])
#     a   b   c
# 1  11  21  31
# 2  12  22  32
# 3  13  23  33

# from dict to dataframe
pd.DataFrame.from_dict(dict)

df.mean()  # mean of each column
df.shape   # (rows,columns)
df.columns # column names
df.index   # Describe index
df.info()  # Info on DataFrame
df.count() # Number of non-NA values


df[3].value_counts() # frequency table of a column, e.g. column 3

df.drop_duplicates() # Remove duplicate rows (only considers columns).

df = df.values #convert a pandas dataframe (df) to a numpy ndarray,
```

### Sort

```python
# Order rows by values of a column 
df.sort_values('mpg') # (low to high).
df.sort_values('mpg', ascending=False) # (high to low).

# Shuffle DataFrame rows
df.sample(frac=1) # The frac  specifies the fraction of rows to return in the random sample,  frac=1 means return all rows.
```

### Subset

```python
df.head(n) # Select first n rows.
df.tail(n) # Select last n rows.

# based on poisition
df[0:3] # select the first 3 rows (rows 0,1,2)
df[:5]  # select the first 5 rows (rows 0,1,2,3,4)
df[-1:] # select the last row 

#iloc: based on positions  (it only takes integers).
# rows:
df.iloc[0] # select the first row
df.iloc[2:] # select every row beginning with the third row
df.iloc[-1] # last row of data frame 
# Columns:
data.iloc[:,0] # first column of data frame 
data.iloc[:,1] # second column of data frame 
data.iloc[:,-1] # last column of data frame 
# rows and columns
df.iloc[0:3, 1:4] # select the first 3 rows (rows 0,1,2) and (columns 1, 2 and 3)

#loc: label based indexing.
df.loc[:3] # slice up to and including label 3
df.loc[:'john'] # select rows by names/labels
df.loc[df['column_name'] == some_value] # select rows whose column value equals a scalar
df.loc[~df['column_name'].isin(some_values)] # select rows whose column value is in an iterable
df.loc[(df['column_name'] == some_value) & df['other_column'].isin(some_values)] 

# Select columns by names
df['name'] 
df[['name', 'age']]

# select col_name1, col_name2 from table where column_name = some_value.
df.loc[df['column_name'] == some_value][[col_name1, col_name2]]

df[df.Length>7 ] # select rows that meet logical criteria.

df.drop(df.tail(n).index) # drop last n rows
df.drop(df.head(n).index) # drop first n rows

# loop for each row
for index, row in df.iterrows():
    print row['column_name_1'], row['column_name_2']
# 10 100
# 11 110
# 12 120
```

### Add 
```python
# append a column
df['new_col'] = pd.Series(np.arange(0, 100), index=df.index)

# Append a dataframe
df = pd.DataFrame([[1, 2], [3, 4]], columns=list('AB'))
df
#    A  B
# 0  1  2
# 1  3  4

df2 = pd.DataFrame([[5, 6], [7, 8]], columns=list('AB'))
df.append(df2)
#    A  B
# 0  1  2
# 1  3  4
# 0  5  6
# 1  7  8

# With ignore_index set to True:
df.append(df2, ignore_index=True)
#    A  B
# 0  1  2
# 1  3  4
# 2  5  6
# 3  7  8

# reset index if necessary
df = df.reset_index(drop=True) 
```

### Remove
```python
# delete column on i index
df.drop(df.columns[i], axis=1) # note: it will remove both columns if there is duplicate names in columns, 
```

### Group

```python
grouped = df.groupby('gender')
for name, group in grouped:
    print("name  :", name)
    print("group :", group)
```

### Handle NaN

```python
df.fillna(0) # Replace all the NaN values with Zero
```

# Regular expression

```python
import re
m = re.search('(?<=abc)def', 'abcdef')
m.group(0)
# 'def'
```

# IO

## Read write CSV

```python
pd.read_csv('file.csv', header=None, nrows=5)
pd.to_csv('myDataFrame.csv')

pd.read_excel('file.xlsx')
pd.to_excel('dir/myDataFrame.xlsx', sheet_name='Sheet1')
```

## Read head lines of a large text file

```python
file_name = "C:\\Users\\xxxxx\\Desktop\\2014101709-12.txt"

with open(file_name) as myfile:
    head = [next(myfile) for x in range(20)]
print(head)

```

## List files only in the current directory

```python
import os as os
files = [f for f in os.listdir('.') if os.path.isfile(f)]
for f in files:
    print(f)
```


# Real time plot with python

```python
import numpy as np
import matplotlib.pyplot as plt

plt.axis([0, 10, 0, 1])
plt.ion()

for i in range(100):
    y = np.random.random()
    plt.scatter(i, y)
    plt.pause(0.5)

while True:
    plt.pause(0.5)
```

# plot a hist graph

```python
import random
values = [random.randint(0, 10) for _ in range(50)]
import matplotlib.pyplot as plt
plt.hist(values, bins=11)
```

# Install package

in cmd comand window
```python
# PyPI
pip install py2exe
#conda
conda install --channel https://conda.anaconda.org/manmadescience py2exe


conda install pandas
pip install pandas
```

  NTLM support for Python3
   
No working package for Pthon3 at the moment

  * Install NTLM package for 2.x first
  * Download NTLM package for 3.x files and replace installed file
  